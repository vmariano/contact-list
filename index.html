<!DOCTYPE html>
<html class="ui-mobile">
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="bower_components/jquery-mobile-bower/css/jquery.mobile-1.4.5.min.css">
    <title>Page Title</title>

    <title>Contact list</title>
</head>


<body>

<!-- Start of first page -->
<div data-role="page" id="foo">
    <div data-role="header">
        <h1>Contact list</h1>
    </div>
    <div role="main" class="ui-content">
        <ul id="contactList" data-insert="true" class="ui-li-has-thumb" data-role="listview"></ul>
    </div>
</div>
<!-- /page -->

<!-- Start of second page -->
<div data-role="page" id="bar">
    <div data-role="header">
        <h1>Bar</h1>
    </div><!-- /header -->

    <div role="main" class="ui-content">
        <p>I'm the second in the source order so I'm hidden when the page loads. I'm just shown if a link that references my id is beeing clicked.</p>
        <p><a href="#foo">Back to foo</a></p>
    </div><!-- /content -->

    <div data-role="footer">
        <h4>Page Footer</h4>
    </div><!-- /footer -->
</div><!-- /page -->
</body>
<script id="contact-template" type="text/x-handlebars-template">
    <li>
        <a href="#">
            <img src="{{imagePath}}">
            <h1>{{name}}</h1>
            <p>{{phone}}</p>
        </a>
    </li>
</script>

<script src="bower_components/handlebars/handlebars.min.js"></script>
<script src="bower_components/jquery/jquery.min.js"></script>
<script src="bower_components/jquery-mobile-bower/js/jquery.mobile-1.4.5.min.js"></script>
<script src="bower_components/underscore/underscore-min.js"></script>
<script>
    $(document).on( "ready", function() {
//    $(document).on('pageinit', function() {
        var template = Handlebars.compile($('#contact-template').html());
        $.get('https://solstice.applauncher.com/external/contacts.json', function (response) {
            var contactList = $('#contactList');
            _.each(response, function(contact) {
                        console.log(contact);
                contactList.append(
                        template({
                              name: contact.name
                            , phone: contact.phone.home
                            , imagePath:  contact.smallImageURL
                        })
                )
            });
            contactList.listview( "refresh" );
        })
    });
</script>
</html>

